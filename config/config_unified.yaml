# -*- coding: utf-8 -*-
# 免疫原性优化管道 - 统一配置文件
# 这个文件包含了所有参数、环境和路径的统一配置

# =============================================================================
# 外部工具路径配置
# =============================================================================
tools:
  # AlphaFold3 配置
  alphafold3:
    path: ""  # 示例: "/opt/alphafold3"
    model_weights: ""  # 示例: "/opt/alphafold3/model_weights"
    executable: "alphafold3"
    
  # ProteinMPNN 配置
  proteinmpnn:
    path: ""  # 示例: "/opt/ProteinMPNN"
    model_weights: ""  # 示例: "/opt/ProteinMPNN/model_weights"
    executable: "protein_mpnn.py"
    
  # NetMHCIIpan 配置
  netmhcii:
    path: ""  # 示例: "/opt/netMHCIIpan"
    executable: "netMHCIIpan"
    
  # Rosetta 配置
  rosetta:
    path: ""  # 示例: "/opt/rosetta"
    executable: "interface_analyzer"
    bin_path: "main/source/bin"  # Rosetta 可执行文件子路径

# =============================================================================
# 用户输入配置
# =============================================================================
user_input:
  # 用户提供的抗原位点文件路径
  epitopes_path: ""  # CSV格式，包含列：sequence, start, end

# =============================================================================
# 管道参数配置
# =============================================================================
pipeline:
  # 基本参数
  basic:
    default_output_dir: "results"
    default_log_level: "INFO"
    max_parallel_jobs: 4
    
  # ProteinMPNN 参数
  proteinmpnn:
    default_temperatures: [0.1, 0.3, 0.5]
    default_samples_per_temp: 20
    batch_size: 1
    timeout: 1800  # 30分钟
    
  # AlphaFold3 参数
  alphafold3:
    default_rmsd_threshold: 2.0
    max_template_date: "2024-01-01"
    num_multimer_predictions_per_model: 1
    timeout: 7200  # 2小时
    
  # NetMHCIIpan 参数
  netmhcii:
    default_hla_alleles:
      - "DRB1*01:01"
      - "DRB1*03:01"
      - "DRB1*04:01"
      - "DRB1*07:01"
      - "DRB1*08:01"
      - "DRB1*11:01"
      - "DRB1*13:01"
      - "DRB1*15:01"
    timeout: 1800  # 30分钟
    
  # Rosetta 接口分析参数
  rosetta:
    default_dg_dsasa_threshold: -0.5
    default_buns_threshold: 5
    default_packstat_threshold: 0.6
    timeout: 300  # 5分钟
    
  # 排序和过滤参数
  ranking:
    max_candidates: 10
    ranking_criteria: ["RMSD", "dG_dSASA", "packstat", "BUNS"]
    ranking_ascending: [true, true, false, true]

# =============================================================================
# 系统配置
# =============================================================================
system:
  # 计算资源
  resources:
    max_memory_gb: 32
    max_cpu_cores: 16
    use_gpu: false
    cuda_device: "0"
    
  # 临时文件
  temp:
    temp_dir: "/tmp"  # Linux临时目录
    cleanup_temp_files: true
    
  # 日志配置
  logging:
    log_file: "pipeline.log"
    max_log_size_mb: 100
    backup_count: 5
    log_format: "%(asctime)s - %(levelname)s - %(message)s"

# =============================================================================
# 高级配置
# =============================================================================
advanced:
  # 缓存配置
  cache:
    enable_cache: true
    cache_dir: "cache"
    cache_expiry_hours: 24
    
  # 重试配置
  retry:
    max_retries: 3
    retry_delay_seconds: 5
    exponential_backoff: true
    
  # 性能优化
  performance:
    enable_parallel_processing: true
    chunk_size: 10
    memory_efficient_mode: false
